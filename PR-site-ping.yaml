---
- name: Test SSH Connection to EC2 Instance
  hosts: all
  tasks:
    - name: Check SSH connection to EC2
      ansible.builtin.command: "exit"
      register: ssh_check
      ignore_errors: yes

    - name: Fail if SSH connection fails
      fail:
        msg: "SSH connection failed to EC2 instance"
      when: ssh_check.rc != 0

    - name: Success message if SSH connection passes
      debug:
        msg: "SSH connection successful to EC2 instance"
      when: ssh_check.rc == 0
